<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>38dee786e14b49a59c01d16a744f003e</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="introduction" class="cell markdown" id="_cL1Czuv_Aqx">
<h2>Introduction</h2>
</section>
<div class="cell markdown" id="51OrAvPrLmDX">
<ol>
<li><p>This is project about creating personal Logistic regression classifier and Comparing the performance with the model creation using the inbuilt library scikit learn.</p></li>
<li><p>The dataset for this procject is "Heart Failure Prediction Dataset" downloaded from <a href="https://www.kaggle.com/datasets/fedesoriano/heart-failure-prediction">Kaggle</a>.</p></li>
<li><p>The outflow of the project is as:</p></li>
</ol>
<p>a. Overview of the data</p>
<p>b. Visualization</p>
<p>c. Data Processing</p>
<p>d. Classifier Modeling</p>
<p>e. Classifier using Scikit learn</p>
<p>f. Comparision and coclustion</p>
</div>
<div class="cell markdown" id="Em53vNu4-_OU">
<p>#Overview of the data</p>
</div>
<div class="cell code" data-execution_count="1" id="JNcX3DALRYCU">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imporiting the required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> style</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;dark_background&#39;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="2" id="ImJ4n_7SWeRQ">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;heart.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="JCGsIfrvzZAO" data-outputId="dd9c4838-b9b6-49ba-afea-d5cdb01cc6a1">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The simple overview of the data is</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">

  <div id="df-861a6f12-535a-4a01-a20c-5fecb306e86f">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Sex</th>
      <th>ChestPainType</th>
      <th>RestingBP</th>
      <th>Cholesterol</th>
      <th>FastingBS</th>
      <th>RestingECG</th>
      <th>MaxHR</th>
      <th>ExerciseAngina</th>
      <th>Oldpeak</th>
      <th>ST_Slope</th>
      <th>HeartDisease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40</td>
      <td>M</td>
      <td>ATA</td>
      <td>140</td>
      <td>289</td>
      <td>0</td>
      <td>Normal</td>
      <td>172</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>49</td>
      <td>F</td>
      <td>NAP</td>
      <td>160</td>
      <td>180</td>
      <td>0</td>
      <td>Normal</td>
      <td>156</td>
      <td>N</td>
      <td>1.0</td>
      <td>Flat</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>M</td>
      <td>ATA</td>
      <td>130</td>
      <td>283</td>
      <td>0</td>
      <td>ST</td>
      <td>98</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48</td>
      <td>F</td>
      <td>ASY</td>
      <td>138</td>
      <td>214</td>
      <td>0</td>
      <td>Normal</td>
      <td>108</td>
      <td>Y</td>
      <td>1.5</td>
      <td>Flat</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>54</td>
      <td>M</td>
      <td>NAP</td>
      <td>150</td>
      <td>195</td>
      <td>0</td>
      <td>Normal</td>
      <td>122</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-861a6f12-535a-4a01-a20c-5fecb306e86f')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-861a6f12-535a-4a01-a20c-5fecb306e86f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-861a6f12-535a-4a01-a20c-5fecb306e86f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="yijUQUpS1Wuw" data-outputId="1af1ad55-0f74-459b-a03c-e6ae246d3197">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding a general sense of the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 918 entries, 0 to 917
Data columns (total 12 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   Age             918 non-null    int64  
 1   Sex             918 non-null    object 
 2   ChestPainType   918 non-null    object 
 3   RestingBP       918 non-null    int64  
 4   Cholesterol     918 non-null    int64  
 5   FastingBS       918 non-null    int64  
 6   RestingECG      918 non-null    object 
 7   MaxHR           918 non-null    int64  
 8   ExerciseAngina  918 non-null    object 
 9   Oldpeak         918 non-null    float64
 10  ST_Slope        918 non-null    object 
 11  HeartDisease    918 non-null    int64  
dtypes: float64(1), int64(6), object(5)
memory usage: 86.2+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="f4tCRD9Jsrc3" data-outputId="06d6fcaa-851f-4c6c-df5b-e9b3fc47c7ce">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Categorical</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>features_cat <span class="op">=</span> df.select_dtypes(include <span class="op">=</span> [<span class="st">&#39;object&#39;</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> features_cat.columns:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(col, df[col].unique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Sex [&#39;M&#39; &#39;F&#39;]
ChestPainType [&#39;ATA&#39; &#39;NAP&#39; &#39;ASY&#39; &#39;TA&#39;]
RestingECG [&#39;Normal&#39; &#39;ST&#39; &#39;LVH&#39;]
ExerciseAngina [&#39;N&#39; &#39;Y&#39;]
ST_Slope [&#39;Up&#39; &#39;Flat&#39; &#39;Down&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0hWqsrgYvyVr" data-outputId="0e02bbb9-9f32-4cb5-b18e-1ef9093af295">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#nan</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="2VlgitlrxBli" data-outputId="a227283b-e39d-4154-96ab-7e5c026dbe74">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking if categorical</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>feature_num <span class="op">=</span> df.select_dtypes(include <span class="op">=</span> [np.number])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> feature_num.columns:</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(col, <span class="bu">len</span>(df[col].unique()))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Age 50
RestingBP 67
Cholesterol 222
FastingBS 2
MaxHR 119
Oldpeak 53
HeartDisease 2
</code></pre>
</div>
</div>
<div class="cell markdown" id="uX3pqSqz3Ot0">
<p><strong>Observations</strong></p>
<ol>
<li>918 samples with zero null</li>
<li>11 features where</li>
</ol>
<p>a. 1 float - Oldpeak, from above information it looks like non categorical</p>
<p>b. 4 int - Age, RestingBP, Cholesterol, FastingBS, MaxHR all are non categorical features</p>
<p>c. Age, RestingBP, Cholesterol, FastingBS, MaxHR, and Oldpeak are continuous variable</p>
<p>c. Sex, ChestPainType, RestingECG, ExerciseAngina, ST_Slope are the categorical features</p>
<p>d. HeartDisease is the target variable with 0 and 1.</p>
<ol>
<li>Looks like there is no typo in the dataset</li>
</ol>
</div>
<section id="visualization" class="cell markdown" id="-rmQVKBcMYM7">
<h1>Visualization</h1>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dpIjRrdl8kbN" data-outputId="dc551490-09a8-4950-a62f-81e0d716afa4">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Genrel view of target variable the</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>xydf <span class="op">=</span> df[[<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Cholesterol&#39;</span>, <span class="st">&#39;HeartDisease&#39;</span>]]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>xy0 <span class="op">=</span> xydf[xydf[<span class="st">&#39;HeartDisease&#39;</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>xy1 <span class="op">=</span> xydf[xydf[<span class="st">&#39;HeartDisease&#39;</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> <span class="st">&#39;Age&#39;</span>, y <span class="op">=</span> <span class="st">&#39;Cholesterol&#39;</span>, data <span class="op">=</span> xy1, marker <span class="op">=</span> <span class="st">&#39;*&#39;</span>, color <span class="op">=</span> <span class="st">&#39;blue&#39;</span>, label <span class="op">=</span> <span class="st">&#39;1&#39;</span>)<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> <span class="st">&#39;Age&#39;</span>, y <span class="op">=</span> <span class="st">&#39;Cholesterol&#39;</span>, data <span class="op">=</span> xy0, marker <span class="op">=</span> <span class="st">&#39;+&#39;</span>, color <span class="op">=</span> <span class="st">&#39;yellow&#39;</span>, label <span class="op">=</span> <span class="st">&#39;0&#39;</span>)<span class="op">;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/e25ab2f2e1173aeff18b1205980e8ca00ccdda72.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:344,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="wzgU9IjUjTll" data-outputId="b879f8f1-bafd-42ca-9121-6066a3503d6a">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizing the relation among numerical features</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(), annot <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff5d0260590&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/d4a988e6280b20e89a71bf087502abda12d6564e.png" /></p>
</div>
</div>
<div class="cell markdown" id="FRV6fw2Ak2FZ">
<ol>
<li>There very small co-relation among features like MaxHR slightly decreases with age.</li>
<li>Heart Disease mostly depends on Age, Cholesterol, FastingBP, and MaxHR.</li>
</ol>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="RIzV0bwRdym7" data-outputId="6fb74dc4-160d-410f-efc9-2de4a54cceee">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizing Categoriacal features</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> df.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>categories.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<pre><code>Index([&#39;Sex&#39;, &#39;ChestPainType&#39;, &#39;RestingECG&#39;, &#39;ExerciseAngina&#39;, &#39;ST_Slope&#39;], dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-bAUkMDie1Yc" data-outputId="4cd9e565-9e08-4b0b-acbb-3ecdebc8548c">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categories.columns:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(col, categories[col].value_counts(), <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Sex M    725
F    193
Name: Sex, dtype: int64 

ChestPainType ASY    496
NAP    203
ATA    173
TA      46
Name: ChestPainType, dtype: int64 

RestingECG Normal    552
LVH       188
ST        178
Name: RestingECG, dtype: int64 

ExerciseAngina N    547
Y    371
Name: ExerciseAngina, dtype: int64 

ST_Slope Flat    460
Up      395
Down     63
Name: ST_Slope, dtype: int64 

</code></pre>
</div>
</div>
<div class="cell markdown" id="qh806f_KgCEa">
<ol>
<li>There are more samples corresponding to Male compared to Females.</li>
<li>547 people out of 918 (arround 60 % people) do not do exercise.</li>
</ol>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LK0HCnjcf8jN" data-outputId="51510fce-f14f-46e1-f0c3-753a018fb490">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us see if there is any relation of sex, and age with Heart disease</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(x<span class="op">=</span><span class="st">&#39;Sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;Age&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;HeartDisease&#39;</span>, data <span class="op">=</span> df)<span class="op">;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/c9ebf8697133eb935c690adf045304ac8f590073.png" /></p>
</div>
</div>
<div class="cell markdown" id="_rJa6WXBhjgV">
<ol>
<li><p>Look like Male have more heart problem than female and the tendency of having heart disease increases with age.</p></li>
<li><p>Female mostly get heart disease after 50 but the chance of getting heart disease in male starts even after 40.</p></li>
</ol>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="pIJxjSqihjMc" data-outputId="8915ec27-cb25-4190-8c1c-9b08be9bb1fb">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let us see if there is any relation of sex, and age with Heart disease</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(x<span class="op">=</span><span class="st">&#39;Sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;Cholesterol&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;HeartDisease&#39;</span>, data <span class="op">=</span> df)<span class="op">;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/f6a49c8a275bf7979a99e1457f3e76dbcafd36f2.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:388,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="C5aAm0x1kSfu" data-outputId="828a80cd-8be8-497f-a574-8ba80d14aad1">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.gcf()<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(<span class="dv">15</span>, <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(x<span class="op">=</span><span class="st">&#39;Age&#39;</span>, y<span class="op">=</span><span class="st">&#39;Cholesterol&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;Sex&#39;</span>, data <span class="op">=</span> df)<span class="op">;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/15c5ebe2a1be3292ca286b05e2e7e59ce962938a.png" /></p>
</div>
</div>
<div class="cell markdown" id="iTyKPrtTjnUF">
<ol>
<li>Male and Female both have arround same amount of Cholesterol which between 200 and 300.</li>
<li>Male and Female both have arround same amount of Cholesterol irrespective of the age after 40.</li>
</ol>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="qg3Mf-otjl1c" data-outputId="b497e632-8c58-4f30-e821-eb1cc755374c">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of Continuous Variables</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;RestingBP&#39;</span>, <span class="st">&#39;Cholesterol&#39;</span>, <span class="st">&#39;MaxHR&#39;</span>, <span class="st">&#39;Oldpeak&#39;</span>]:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  sns.kdeplot(df[col])<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  plt.show()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/5ff16eee992b6e7c1fed52c1b75d020a4f9b09bb.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/2a48297ba3aaccde6c61493cc8730d5c7337810d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/aa407a749f57c648aa575409c94316959d198294.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/a2ea88a89a3b12c6e0f9c35acd6de3745c28d86d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/6becf59c94e5d8663aca6be06d7f5f07255dbcea.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>

</code></pre>
</div>
</div>
<div class="cell markdown" id="R7rJFGEbcFdu">
<p>None of the continuous variables are highly skewed. Therefore, no log transformation will be required.</p>
</div>
<section id="data-processing" class="cell markdown" id="2T9EXyHbcuIQ">
<h1>Data Processing</h1>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="FQsAvsGOcm1D" data-outputId="f2b98a13-4b2f-461e-9b81-0c362b82aa81">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separating the features and Target</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> df[<span class="st">&#39;HeartDisease&#39;</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df.drop(<span class="st">&#39;HeartDisease&#39;</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>features.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">

  <div id="df-f27deda0-33f0-4732-ae3f-ad9e901b60b5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Sex</th>
      <th>ChestPainType</th>
      <th>RestingBP</th>
      <th>Cholesterol</th>
      <th>FastingBS</th>
      <th>RestingECG</th>
      <th>MaxHR</th>
      <th>ExerciseAngina</th>
      <th>Oldpeak</th>
      <th>ST_Slope</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40</td>
      <td>M</td>
      <td>ATA</td>
      <td>140</td>
      <td>289</td>
      <td>0</td>
      <td>Normal</td>
      <td>172</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
    </tr>
    <tr>
      <th>1</th>
      <td>49</td>
      <td>F</td>
      <td>NAP</td>
      <td>160</td>
      <td>180</td>
      <td>0</td>
      <td>Normal</td>
      <td>156</td>
      <td>N</td>
      <td>1.0</td>
      <td>Flat</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>M</td>
      <td>ATA</td>
      <td>130</td>
      <td>283</td>
      <td>0</td>
      <td>ST</td>
      <td>98</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48</td>
      <td>F</td>
      <td>ASY</td>
      <td>138</td>
      <td>214</td>
      <td>0</td>
      <td>Normal</td>
      <td>108</td>
      <td>Y</td>
      <td>1.5</td>
      <td>Flat</td>
    </tr>
    <tr>
      <th>4</th>
      <td>54</td>
      <td>M</td>
      <td>NAP</td>
      <td>150</td>
      <td>195</td>
      <td>0</td>
      <td>Normal</td>
      <td>122</td>
      <td>N</td>
      <td>0.0</td>
      <td>Up</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f27deda0-33f0-4732-ae3f-ad9e901b60b5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f27deda0-33f0-4732-ae3f-ad9e901b60b5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f27deda0-33f0-4732-ae3f-ad9e901b60b5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:270,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="vrHMF7IDddDA" data-outputId="c3997578-7020-4ffb-81fe-8220cf5ff5e8">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Encoding the categorical variables</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">##Every column having more than two unique values will be splitted in the number of values that column have</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> LabelEncoder(df, col):</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  unique_values <span class="op">=</span> <span class="bu">list</span>(df[col].unique())</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> value <span class="kw">in</span> unique_values:</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    column <span class="op">=</span> col <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> value</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    df[column] <span class="op">=</span> df[col].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> value <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  df.drop(col, axis  <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(df)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;ChestPainType&#39;</span>, <span class="st">&#39;RestingECG&#39;</span>, <span class="st">&#39;ST_Slope&#39;</span>, <span class="st">&#39;Sex&#39;</span>]:</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  features <span class="op">=</span> LabelEncoder(features, col)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Encoding ExercisAngina</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>features[<span class="st">&#39;ExerciseAngina&#39;</span>] <span class="op">=</span> features[<span class="st">&#39;ExerciseAngina&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x : <span class="dv">1</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">&#39;Y&#39;</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>features.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-ae9ed1e4-84b6-44ec-b4f7-a5da24983d03">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>RestingBP</th>
      <th>Cholesterol</th>
      <th>FastingBS</th>
      <th>MaxHR</th>
      <th>ExerciseAngina</th>
      <th>Oldpeak</th>
      <th>ChestPainType_ATA</th>
      <th>ChestPainType_NAP</th>
      <th>ChestPainType_ASY</th>
      <th>ChestPainType_TA</th>
      <th>RestingECG_Normal</th>
      <th>RestingECG_ST</th>
      <th>RestingECG_LVH</th>
      <th>ST_Slope_Up</th>
      <th>ST_Slope_Flat</th>
      <th>ST_Slope_Down</th>
      <th>Sex_M</th>
      <th>Sex_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>40</td>
      <td>140</td>
      <td>289</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>49</td>
      <td>160</td>
      <td>180</td>
      <td>0</td>
      <td>156</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>37</td>
      <td>130</td>
      <td>283</td>
      <td>0</td>
      <td>98</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48</td>
      <td>138</td>
      <td>214</td>
      <td>0</td>
      <td>108</td>
      <td>1</td>
      <td>1.5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>54</td>
      <td>150</td>
      <td>195</td>
      <td>0</td>
      <td>122</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ae9ed1e4-84b6-44ec-b4f7-a5da24983d03')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ae9ed1e4-84b6-44ec-b4f7-a5da24983d03 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ae9ed1e4-84b6-44ec-b4f7-a5da24983d03');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:270,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="gQrtZsM_hEgU" data-outputId="98a627d3-1c13-4568-9ca4-b349e2d7d3b9">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Trasnformation of continuous variables</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scalar(df, col):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">max</span> <span class="op">=</span> df[col].<span class="bu">max</span>()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">min</span> <span class="op">=</span> df[col].<span class="bu">min</span>()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">range</span> <span class="op">=</span> <span class="bu">max</span> <span class="op">-</span> <span class="bu">min</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  df[col] <span class="op">=</span> (df[col] <span class="op">-</span> <span class="bu">min</span>)<span class="op">/</span><span class="bu">range</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(df)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;RestingBP&#39;</span>, <span class="st">&#39;Cholesterol&#39;</span>, <span class="st">&#39;MaxHR&#39;</span>, <span class="st">&#39;Oldpeak&#39;</span>]:</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  scalar(features, col)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>features.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-aa71f92f-1eb9-4529-9710-69929d324763">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>RestingBP</th>
      <th>Cholesterol</th>
      <th>FastingBS</th>
      <th>MaxHR</th>
      <th>ExerciseAngina</th>
      <th>Oldpeak</th>
      <th>ChestPainType_ATA</th>
      <th>ChestPainType_NAP</th>
      <th>ChestPainType_ASY</th>
      <th>ChestPainType_TA</th>
      <th>RestingECG_Normal</th>
      <th>RestingECG_ST</th>
      <th>RestingECG_LVH</th>
      <th>ST_Slope_Up</th>
      <th>ST_Slope_Flat</th>
      <th>ST_Slope_Down</th>
      <th>Sex_M</th>
      <th>Sex_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.244898</td>
      <td>0.70</td>
      <td>0.479270</td>
      <td>0</td>
      <td>0.788732</td>
      <td>0</td>
      <td>0.295455</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.428571</td>
      <td>0.80</td>
      <td>0.298507</td>
      <td>0</td>
      <td>0.676056</td>
      <td>0</td>
      <td>0.409091</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.183673</td>
      <td>0.65</td>
      <td>0.469320</td>
      <td>0</td>
      <td>0.267606</td>
      <td>0</td>
      <td>0.295455</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.408163</td>
      <td>0.69</td>
      <td>0.354892</td>
      <td>0</td>
      <td>0.338028</td>
      <td>1</td>
      <td>0.465909</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.530612</td>
      <td>0.75</td>
      <td>0.323383</td>
      <td>0</td>
      <td>0.436620</td>
      <td>0</td>
      <td>0.295455</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aa71f92f-1eb9-4529-9710-69929d324763')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aa71f92f-1eb9-4529-9710-69929d324763 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aa71f92f-1eb9-4529-9710-69929d324763');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="5A1lLg_y5IOW">
<p>The features having continuous values are scaled are between 0 and 1. The features having categorical values are ecnoded with 0 and 1. Now the dataset is ready for preparing the model.</p>
</div>
<section id="classifier-modeling" class="cell markdown" id="CPTag86F5miy">
<h1>Classifier Modeling</h1>
</section>
<section id="coverting-the-data-into-matrix-form-for-performing-the-mathematical-operations" class="cell markdown" id="ZWLZB1AJ5wUI">
<h2>Coverting the data into matrix form for performing the mathematical operations</h2>
</section>
<div class="cell markdown" id="Sfhp-oLY6NXY">
<p>It is known that the hypothesis function for Logistic regression classifier is</p>
<p>$ h(X) = \frac{1}{1 + e^{-Z}}$, where <span class="math inline"><em>Z</em></span> = <span class="math inline"><em>X</em><em>θ</em></span></p>
<p>Let the dataset has <span class="math inline"><em>m</em></span> features and <span class="math inline"><em>n</em></span> samples then,</p>
<ol>
<li><span class="math inline"><em>h</em>(<em>X</em>)</span> -&gt; Vector of size <span class="math inline"><em>n</em></span></li>
<li><span class="math inline"><em>θ</em></span> is a constant vector with <span class="math inline"><em>m</em> + 1</span> co-ordinates</li>
<li><span class="math inline"><em>Z</em></span> -&gt; Vector of size <span class="math inline"><em>n</em></span></li>
<li><span class="math inline"><em>X</em></span> is the features matrix where the first column has entry 1 in every row therefore the size of <span class="math inline"><em>X</em></span> is <span class="math inline"><em>n</em> × (<em>m</em>+1)</span></li>
</ol>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="DncpfouZ_fpT" data-outputId="94ab6382-c663-41ff-e4b6-a6bb3c82917b">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> features.shape[<span class="dv">0</span>] <span class="co">#number of samples</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> features.shape[<span class="dv">1</span>] <span class="co">#number of features</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>features_mat <span class="op">=</span> features.to_numpy() </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.hstack((np.ones((n, <span class="dv">1</span>)), features_mat)) <span class="co">#adding column of 1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, X[<span class="dv">0</span>:<span class="dv">3</span>, :])</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> target.to_numpy()</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, Y[:<span class="dv">10</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>X 
 [[1.         0.24489796 0.7        0.47927032 0.         0.78873239
  0.         0.29545455 1.         0.         0.         0.
  1.         0.         0.         1.         0.         0.
  1.         0.        ]
 [1.         0.42857143 0.8        0.29850746 0.         0.67605634
  0.         0.40909091 0.         1.         0.         0.
  1.         0.         0.         0.         1.         0.
  0.         1.        ]
 [1.         0.18367347 0.65       0.46932007 0.         0.26760563
  0.         0.29545455 1.         0.         0.         0.
  0.         1.         0.         1.         0.         0.
  1.         0.        ]]
Y 
 [0 1 0 1 0 0 0 0 1 0]
</code></pre>
</div>
</div>
<section id="splittig-the-data-for-train-and-test" class="cell markdown" id="_C6MFWA5Bl-o">
<h3>Splittig the data for train and test</h3>
</section>
<div class="cell code" id="tBLX4uENBsCF">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ntrain <span class="op">=</span> <span class="bu">round</span>(<span class="fl">0.8</span><span class="op">*</span>n) <span class="co">#test_size = 0.2</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>xtrain <span class="op">=</span> X[<span class="dv">0</span>:ntrain, :]  </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>xtest <span class="op">=</span> X[ntrain:n<span class="op">+</span><span class="dv">1</span>,:]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ytrain <span class="op">=</span> Y[<span class="dv">0</span>:ntrain] </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>ytest <span class="op">=</span> Y[ntrain:]</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ssJkme-Cd0T5" data-outputId="b7010c13-8c9b-4fad-e514-990fd9ff66cb">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>np.size(ytrain)</span></code></pre></div>
<div class="output execute_result" data-execution_count="30">
<pre><code>734</code></pre>
</div>
</div>
<section id="functions-involved-in-classifier" class="cell markdown" id="yqz2aiCxCknD">
<h2>Functions involved in classifier</h2>
</section>
<div class="cell markdown" id="bmPB9pGoEBcJ">
<ol>
<li>Hypothesis function: <span class="math inline">$h(x) = \frac{1}{1 + e^{-z}}$</span> --&gt; predicted value</li>
<li><span class="math inline"><em>Z</em> = <em>X</em><em>θ</em></span></li>
<li>Cost Function: <span class="math inline">$J(\theta) = -\frac{1}{n}[log(1 - h(x)) + yz]$</span>, where <span class="math inline"><em>y</em></span> is actual value</li>
<li>As the minimization of the cost function is not a simple function, either Newton Raphson or the gredient descent method would be used to solve.</li>
<li>Gredient function: <span class="math inline">∇<sub><em>θ</em></sub><em>J</em>(<em>θ</em>) = <em>x</em><sup><em>T</em></sup>(<em>y</em>−<em>h</em>(<em>x</em>))</span></li>
<li>Getting the optimized theta: <span class="math inline"><em>θ</em><sub><em>n</em><em>e</em><em>w</em></sub> = <em>θ</em><sub><em>o</em><em>l</em><em>d</em></sub> − <em>η</em>{<em>x</em><sup><em>T</em></sup>(<em>y</em>−<em>h</em>(<em>x</em>))}</span>, where <span class="math inline"><em>η</em></span> is learing rate</li>
</ol>
</div>
<div class="cell code" id="XY6EB9C3C0n3">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis function</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sigma(xtrain,theta):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  z <span class="op">=</span> np.matmul(xtrain, theta)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  ze <span class="op">=</span> np.exp(<span class="op">-</span>z)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  hx <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> ze)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(z, hx)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Cost function </span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> costf(z,hx,ytrain):</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  c1 <span class="op">=</span> np.matmul(ytrain, np.log(hx))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  c2 <span class="op">=</span> np.matmul((<span class="dv">1</span><span class="op">-</span>ytrain), np.log(<span class="dv">1</span><span class="op">-</span>hx))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  cost <span class="op">=</span> <span class="op">-</span>(c1<span class="op">+</span>c2)<span class="op">/</span>n</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(cost)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimization of cost function</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Optimize(xtrain,ytrain,repeat,eta):</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> np.shape(xtrain)[<span class="dv">0</span>]</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  theta <span class="op">=</span> np.random.random(np.shape(xtrain)[<span class="dv">1</span>]) <span class="co">#initialization of theta</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  cost_list <span class="op">=</span> []                           <span class="co">#list of cost calculated for a learning rate for visualizing the variation of cost </span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repeat):</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    (z, hx) <span class="op">=</span> sigma(xtrain,theta)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    nabla <span class="op">=</span> np.matmul(xtrain.transpose(), (hx<span class="op">-</span>ytrain))<span class="op">/</span>n <span class="co">#the gredient</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> theta <span class="op">-</span> eta<span class="op">*</span>nabla</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    cost_list.append(costf(z,hx,ytrain))</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(theta, cost_list)                                                     </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co">#predicting labels</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict(xtest,theta):</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  (z, hx) <span class="op">=</span> sigma(xtest,theta)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  ypred <span class="op">=</span> np.array([<span class="dv">1</span> <span class="cf">if</span> x<span class="op">&gt;=</span><span class="fl">0.5</span> <span class="cf">else</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> hx])</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(ypred)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Creatig confusion matrix</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> creat_cm(ytest,ypred):</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  cm <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">&#39;predicted 0&#39;</span>, <span class="st">&#39;predicted 1&#39;</span>])</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  (zero, zeroOne, one, oneZero) <span class="op">=</span> (<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(np.size(ytest)):</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ytest[i] <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> ypred[i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>      zero <span class="op">=</span> zero <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ytest[i] <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> ypred[i] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>      zeroOne <span class="op">=</span> zeroOne <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ytest[i] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> ypred[i] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>      one <span class="op">=</span> one <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ytest[i] <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> ypred[i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>      oneZero <span class="op">=</span> oneZero <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  cm.loc[<span class="st">&#39;Actual 0&#39;</span>] <span class="op">=</span> [zero, zeroOne]</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  cm.loc[<span class="st">&#39;Actual 1&#39;</span>] <span class="op">=</span> [oneZero, one]</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(cm)</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a><span class="co">#the Decision metrics</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> metrics(cm):</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  metric <span class="op">=</span> {}</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> cm[<span class="st">&#39;predicted 0&#39;</span>].<span class="bu">sum</span>() <span class="op">+</span> cm[<span class="st">&#39;predicted 1&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  metric[<span class="st">&#39;accuracy&#39;</span>] <span class="op">=</span> (cm[<span class="st">&#39;predicted 0&#39;</span>].loc[<span class="st">&#39;Actual 0&#39;</span>] <span class="op">+</span> cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>])<span class="op">/</span>n</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  metric[<span class="st">&#39;precision&#39;</span>] <span class="op">=</span> (cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>])<span class="op">/</span>(cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>] <span class="op">+</span> cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 0&#39;</span>])</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  metric[<span class="st">&#39;recall&#39;</span>] <span class="op">=</span> (cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>])<span class="op">/</span>(cm[<span class="st">&#39;predicted 1&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>] <span class="op">+</span> cm[<span class="st">&#39;predicted 0&#39;</span>].loc[<span class="st">&#39;Actual 1&#39;</span>])</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>  metric[<span class="st">&#39;F-1 Score&#39;</span>] <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>metric[<span class="st">&#39;precision&#39;</span>]<span class="op">*</span>metric[<span class="st">&#39;recall&#39;</span>]<span class="op">/</span>(metric[<span class="st">&#39;precision&#39;</span>]<span class="op">+</span>metric[<span class="st">&#39;recall&#39;</span>])</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(metric)</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="co">#classifier Modeling </span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classifier(xtrain,ytrain,eta_list,xtest,ytest,repeat):</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  reports <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> [<span class="st">&#39;eta&#39;</span>, <span class="st">&#39;accuracy&#39;</span>, <span class="st">&#39;precision&#39;</span>, <span class="st">&#39;recall&#39;</span>, <span class="st">&#39;F-1 Score&#39;</span>])</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  predicted_values <span class="op">=</span> pd.DataFrame()</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  predicted_values[<span class="st">&#39;Actual label&#39;</span>] <span class="op">=</span> ytest</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  cost_variation <span class="op">=</span> {}</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  theta_variation <span class="op">=</span> {}</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> eta <span class="kw">in</span> eta_list:</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    (theta, cost_list)  <span class="op">=</span> Optimize(xtrain,ytrain,repeat,eta)</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    cost_variation[eta] <span class="op">=</span> cost_list</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    theta_variation[eta] <span class="op">=</span> theta</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    ypred <span class="op">=</span> predict(xtest,theta)</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    predicted_values[<span class="st">&#39;label_&#39;</span><span class="op">+</span><span class="bu">str</span>(eta)] <span class="op">=</span> ypred</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    cm <span class="op">=</span> creat_cm(ytest,ypred)</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    metric <span class="op">=</span> metrics(cm)</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>    metric[<span class="st">&#39;eta&#39;</span>] <span class="op">=</span> eta</span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>    reports <span class="op">=</span> reports.append(metric, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(cost_variation, reports, predicted_values,theta_variation)</span></code></pre></div>
</div>
<div class="cell code" id="oKr4WRdQgtKQ">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>eta_list <span class="op">=</span> [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>(cost_variation, reports, predicted_values,theta_variation) <span class="op">=</span> classifier(xtrain, ytrain, eta_list, xtest, ytest, <span class="dv">1000</span>)</span></code></pre></div>
</div>
<div class="cell code" id="iH0ksuru1krE">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.gcf()<span class="op">;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(<span class="dv">8</span>,<span class="dv">6</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> cost_variation.keys():</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> cost_variation[<span class="fl">0.01</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="bu">len</span>(y)))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  sns.lineplot(x,y,label<span class="op">=</span>key)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:174,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Wyfpb8pa2xLj" data-outputId="5d16e8ec-e4c3-4f2a-a7db-029116df7584">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>reports</span></code></pre></div>
<div class="output execute_result" data-execution_count="87">

  <div id="df-9304c062-c313-461c-92f3-f078d039078e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eta</th>
      <th>accuracy</th>
      <th>precision</th>
      <th>recall</th>
      <th>F-1 Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0001</td>
      <td>0.467391</td>
      <td>0.467391</td>
      <td>1.000000</td>
      <td>0.637037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0010</td>
      <td>0.467391</td>
      <td>0.467391</td>
      <td>1.000000</td>
      <td>0.637037</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0100</td>
      <td>0.750000</td>
      <td>0.700000</td>
      <td>0.813953</td>
      <td>0.752688</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1000</td>
      <td>0.771739</td>
      <td>0.755814</td>
      <td>0.755814</td>
      <td>0.755814</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9304c062-c313-461c-92f3-f078d039078e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9304c062-c313-461c-92f3-f078d039078e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9304c062-c313-461c-92f3-f078d039078e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:138,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="IuQFlzjk0u5T" data-outputId="9a9cf3b0-a0c9-41fc-ab58-d8168b5ab841">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>eta_list <span class="op">=</span> [ <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>classifier(xtrain,ytrain,xtest,ytest,<span class="dv">1000</span>,eta_list)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>eta =  0.001 
 {&#39;accuracy&#39;: 0.7717391304347826, &#39;precision&#39;: 0.7558139534883721, &#39;Recall&#39;: 0.7558139534883721, &#39;F-1 Score&#39;: 0.755813953488372}
eta =  0.01 
 {&#39;accuracy&#39;: 0.7771739130434783, &#39;precision&#39;: 0.7528089887640449, &#39;Recall&#39;: 0.7790697674418605, &#39;F-1 Score&#39;: 0.7657142857142858}
eta =  0.1 
 {&#39;accuracy&#39;: 0.7771739130434783, &#39;precision&#39;: 0.7777777777777778, &#39;Recall&#39;: 0.7325581395348837, &#39;F-1 Score&#39;: 0.7544910179640719}
</code></pre>
</div>
<div class="output display_data">
<pre><code>&lt;Figure size 720x432 with 0 Axes&gt;</code></pre>
</div>
</div>
<div class="cell code" id="XT77dEnvcQwj">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> costf(z,hx,ytrain):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  ze <span class="op">=</span> np.exp(z)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> np.size(z)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  hxx <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> ze)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  cost <span class="op">=</span> np.<span class="bu">sum</span>((np.log(hxx) <span class="op">+</span> np.matmul(ytrain, z))<span class="op">/</span>n)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(cost)</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="HzhXkPYpcWcv" data-outputId="f44ff855-d937-46f9-d484-c0674add124f">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> eta <span class="kw">in</span> eta_list:</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(eta,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,theta_variation[eta])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.0001 
 [0.13349684 0.47694926 0.43077015 0.52900916 0.48727437 0.26937076
 0.23072645 0.00924484 0.61460649 0.50958201 0.82342853 0.29419408
 0.34490218 0.05078802 0.66607007 0.16807083 0.88205953 0.43074446
 0.07643548 0.83354775]
0.001 
 [0.11835009 0.21368097 0.58354663 0.81176857 0.10913029 0.37737561
 0.62274339 0.0669014  0.11756649 0.25770441 0.00958604 0.82504812
 0.19794057 0.57433793 0.44230805 0.47253602 0.446914   0.85548406
 0.20022754 0.21266521]
0.01 
 [-0.85283432  0.18676266 -0.47008446  0.06298485  0.51365889 -0.04134847
  0.8058665   0.46953883 -0.48708716 -0.21609037  0.72749412  0.12102221
  0.20783877  0.34480201  0.65319209 -0.90482245  0.47435321  0.21309659
  0.45313793  0.24421899]
0.1 
 [-0.3409352  -0.05617829 -0.03456318 -0.8920723   1.51032323 -0.90232064
  0.86431808  0.90235451 -0.74694836 -0.1237637   1.23023006  0.3375241
 -0.32851373 -0.22310954 -0.13899839 -1.43491515  1.35586258  0.19553387
  0.38180144 -0.79421407]
1 
 [-0.70686306  0.44682114  0.31856058 -2.55160511  1.6110569  -0.85191257
  0.81043707  1.45116236 -0.76555174 -0.20621917  1.24847406  0.27327992
  0.01222114 -0.05063459  0.2430166  -1.58712206  1.37432028 -0.15008021
  0.32694027 -0.83658276]
</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:174,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="YLNK0zSXdctU" data-outputId="0f65e7bd-4ca3-48d3-a7e3-248de5678f0e">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>reports</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">

  <div id="df-68c735d6-f67f-454b-8a19-fb36d6ad6731">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eta</th>
      <th>accuracy</th>
      <th>precision</th>
      <th>recall</th>
      <th>F-1 Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0001</td>
      <td>0.467391</td>
      <td>0.467391</td>
      <td>1.000000</td>
      <td>0.637037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0010</td>
      <td>0.467391</td>
      <td>0.467391</td>
      <td>1.000000</td>
      <td>0.637037</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0100</td>
      <td>0.728261</td>
      <td>0.666667</td>
      <td>0.837209</td>
      <td>0.742268</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.1000</td>
      <td>0.777174</td>
      <td>0.758621</td>
      <td>0.767442</td>
      <td>0.763006</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-68c735d6-f67f-454b-8a19-fb36d6ad6731')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-68c735d6-f67f-454b-8a19-fb36d6ad6731 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-68c735d6-f67f-454b-8a19-fb36d6ad6731');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="F1UqyMSUhc2k" data-outputId="0d7a5135-f45c-427d-d908-d731cafd2862">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>np.matmul(ytrain,z)</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>1940.6362736316646</code></pre>
</div>
</div>
<div class="cell code" id="9mXrlyQZdSki">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cost <span class="op">=</span> costf(z,hx,ytrain)</span></code></pre></div>
</div>
<div class="cell code" id="urVTkjtvi2PD">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using Scikit learn</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>xtrain, xtest, ytrain, ytest <span class="op">=</span> train_test_split(features, target, test_size <span class="op">=</span> <span class="fl">0.3</span>, random_state <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>classifier <span class="op">=</span> LogisticRegression(random_state <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>classifier.fit(xtrain, ytrain)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>ypred <span class="op">=</span> classifier.predict(xtest)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, ConfusionMatrixDisplay, confusion_matrix, classification_report</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(ytest, ypred)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>report <span class="op">=</span> classification_report(ytest, ypred)</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ID7b3-usjBfj" data-outputId="4274dfdc-3872-464c-e521-b433d80f2988">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(report)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.82      0.77      0.79       113
           1       0.85      0.88      0.86       163

    accuracy                           0.84       276
   macro avg       0.83      0.83      0.83       276
weighted avg       0.84      0.84      0.84       276

</code></pre>
</div>
</div>
<div class="cell code" id="RIocDar_vE7v">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>eta_list <span class="op">=</span> [<span class="fl">0.1</span>]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>(cost_variation, reports, predicted_values,theta_variation) <span class="op">=</span> classifier(xtrain, ytrain, eta_list, xtest, ytest, <span class="dv">1000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="mSwqY9_zwu4l" data-outputId="1bbd7c73-1371-4bd5-de4d-fd0bc6532da9">
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>reports.transpose()</span></code></pre></div>
<div class="output execute_result" data-execution_count="90">

  <div id="df-bc876616-7ae7-4870-9a24-d0b22450b3e9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>eta</th>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.771739</td>
    </tr>
    <tr>
      <th>precision</th>
      <td>0.755814</td>
    </tr>
    <tr>
      <th>recall</th>
      <td>0.755814</td>
    </tr>
    <tr>
      <th>F-1 Score</th>
      <td>0.755814</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bc876616-7ae7-4870-9a24-d0b22450b3e9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bc876616-7ae7-4870-9a24-d0b22450b3e9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bc876616-7ae7-4870-9a24-d0b22450b3e9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" id="t0ocJqgFw-HN">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:279,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="gaNkYu7jxuDW" data-outputId="d1d1d297-4e73-454c-f477-cfac71d14559">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visulaizing the prediction</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>df_pre <span class="op">=</span> df.iloc[ntrain:]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>df_pre <span class="op">=</span> df_pre[[<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Cholesterol&#39;</span>]]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>df_pre[<span class="st">&#39;Actual label&#39;</span>] <span class="op">=</span> <span class="bu">list</span>(predicted_values[<span class="st">&#39;Actual label&#39;</span>])</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>df_pre[<span class="st">&#39;predicted&#39;</span>] <span class="op">=</span> <span class="bu">list</span>(predicted_values[<span class="st">&#39;label_0.1&#39;</span>])</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>true <span class="op">=</span> df_pre[df_pre[<span class="st">&#39;Actual label&#39;</span>] <span class="op">==</span> df_pre[<span class="st">&#39;predicted&#39;</span>]]</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>false <span class="op">=</span> df_pre[df_pre[<span class="st">&#39;Actual label&#39;</span>] <span class="op">!=</span> df_pre[<span class="st">&#39;predicted&#39;</span>]]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> <span class="st">&#39;Age&#39;</span>, y <span class="op">=</span> <span class="st">&#39;Cholesterol&#39;</span>, data <span class="op">=</span> true, marker <span class="op">=</span> <span class="st">&#39;*&#39;</span>, color <span class="op">=</span> <span class="st">&#39;blue&#39;</span>, label <span class="op">=</span> <span class="st">&#39;predicted_true&#39;</span>)<span class="op">;</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x <span class="op">=</span> <span class="st">&#39;Age&#39;</span>, y <span class="op">=</span> <span class="st">&#39;Cholesterol&#39;</span>, data <span class="op">=</span> false, marker <span class="op">=</span> <span class="st">&#39;+&#39;</span>, color <span class="op">=</span> <span class="st">&#39;yellow&#39;</span>, label <span class="op">=</span> <span class="st">&#39;predicted_false&#39;</span>)<span class="op">;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_f8f45ae7ad1f44878615b435a2b4379d/80a582a6140da31c57bca53af63e3792b95591c7.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:423,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="MWIhJLHb2wN6" data-outputId="c8700e8a-c3ef-4250-dbdc-e9404df6114c">
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>false</span></code></pre></div>
<div class="output execute_result" data-execution_count="108">

  <div id="df-decf01cf-8038-4f43-8bd9-2a17e6c8c785">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Cholesterol</th>
      <th>Actual label</th>
      <th>predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>734</th>
      <td>56</td>
      <td>283</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>735</th>
      <td>49</td>
      <td>188</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>736</th>
      <td>54</td>
      <td>286</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>737</th>
      <td>57</td>
      <td>274</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>738</th>
      <td>65</td>
      <td>360</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>913</th>
      <td>45</td>
      <td>264</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>914</th>
      <td>68</td>
      <td>193</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>915</th>
      <td>57</td>
      <td>131</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>916</th>
      <td>57</td>
      <td>236</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>917</th>
      <td>38</td>
      <td>175</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>184 rows × 4 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-decf01cf-8038-4f43-8bd9-2a17e6c8c785')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-decf01cf-8038-4f43-8bd9-2a17e6c8c785 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-decf01cf-8038-4f43-8bd9-2a17e6c8c785');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:423,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="JpsXPUMc3yG-" data-outputId="5bc5615f-2c5d-49e5-9bde-f0934f6bfbda">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>predicted_values</span></code></pre></div>
<div class="output execute_result" data-execution_count="109">

  <div id="df-081e865d-d60b-4ea2-83e7-3b13956467d1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Actual label</th>
      <th>label_0.1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>179</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>180</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>181</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>182</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>183</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>184 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-081e865d-d60b-4ea2-83e7-3b13956467d1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-081e865d-d60b-4ea2-83e7-3b13956467d1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-081e865d-d60b-4ea2-83e7-3b13956467d1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</body>
</html>
